version: 1
disable_existing_loggers: False

formatters:
  simple:
    format: "%(levelname)s: %(message)s"
  
  detailed:
    format: "%(asctime)s | %(name)s | %(levelname)s | %(filename)s:%(lineno)d | %(message)s"
    datefmt: "%Y-%m-%d %H:%M:%S"
  
  # ⭐ NEW: JSON formatter for structured logging (optional but powerful)
  json:
    format: '{"timestamp": "%(asctime)s", "logger": "%(name)s", "level": "%(levelname)s", "file": "%(filename)s", "line": %(lineno)d, "message": "%(message)s"}'
    datefmt: "%Y-%m-%dT%H:%M:%S"

handlers:
  console:
    class: logging.StreamHandler
    level: INFO
    formatter: simple
    stream: ext://sys.stdout

  # --- Pipeline Specific Handlers ---
  
  general_scraper_handler:
    class: logging.handlers.RotatingFileHandler
    level: DEBUG
    formatter: detailed
    filename: logs/general_scraper.log
    maxBytes: 10485760  # 10MB
    backupCount: 3
    encoding: utf-8

  fresher_scraper_handler:
    class: logging.handlers.RotatingFileHandler
    level: DEBUG
    formatter: detailed
    filename: logs/fresher_scraper.log
    maxBytes: 10485760
    backupCount: 3
    encoding: utf-8

  cleaning_handler:
    class: logging.handlers.RotatingFileHandler
    level: INFO
    formatter: detailed
    filename: logs/data_cleaning.log
    maxBytes: 10485760
    backupCount: 3
    encoding: utf-8

  analytics_handler:
    class: logging.handlers.RotatingFileHandler
    level: INFO
    formatter: detailed
    filename: logs/analytics.log
    maxBytes: 10485760
    backupCount: 3
    encoding: utf-8

  model_training_handler:
    class: logging.handlers.RotatingFileHandler
    level: INFO
    formatter: detailed
    filename: logs/model_training.log
    maxBytes: 10485760
    backupCount: 3
    encoding: utf-8

  # ⭐ NEW: Session logger handler
  session_handler:
    class: logging.handlers.RotatingFileHandler
    level: INFO
    formatter: detailed
    filename: logs/sessions.log
    maxBytes: 10485760
    backupCount: 5
    encoding: utf-8

  # ⭐ NEW: Validator handler
  validator_handler:
    class: logging.handlers.RotatingFileHandler
    level: INFO
    formatter: detailed
    filename: logs/data_validation.log
    maxBytes: 10485760
    backupCount: 3
    encoding: utf-8

  # --- Central Error Handler ---
  file_error:
    class: logging.handlers.RotatingFileHandler
    level: ERROR
    formatter: detailed
    filename: logs/error.log
    maxBytes: 10485760
    backupCount: 5
    encoding: utf-8

loggers:
  # General Scraper
  src.scrapers.naukri_general_job_scraper:
    level: DEBUG
    handlers: [console, general_scraper_handler, file_error]
    propagate: no

  # # Fresher Scraper
  # src.pipelines.fresher_scraper:
  #   level: DEBUG
  #   handlers: [console, fresher_scraper_handler, file_error]
  #   propagate: no

  src.scrapers.naukri_fresher_job_scraper:
    level: DEBUG
    handlers: [console, fresher_scraper_handler, file_error]
    propagate: no

  # pipeline specific loggers (if you want to log from pipeline classes directly)
  pipelines.naukri_fresher_job_scraping_pipeline:
    level: INFO
    handlers: [console, fresher_scraper_handler, file_error]
    propagate: no
  
  pipelines.naukri_general_pipeline:
    level: INFO
    handlers: [console, general_scraper_handler, file_error]
    propagate: no

  # Data Cleaning
  src.pipelines.cleaning:
    level: INFO
    handlers: [console, cleaning_handler, file_error]
    propagate: no

  # Analytics
  src.pipelines.analytics:
    level: INFO
    handlers: [console, analytics_handler, file_error]
    propagate: no

  # Model Training
  src.pipelines.model_training:
    level: INFO
    handlers: [console, model_training_handler, file_error]
    propagate: no

  # ⭐ NEW: Session Logger
  ScrapeSessionLogger:
    level: INFO
    handlers: [console, session_handler, file_error]
    propagate: no

  # ⭐ NEW: Data Validator
  DataValidator:
    level: INFO
    handlers: [console, validator_handler, file_error]
    propagate: no

  # Utils (Common functions)
  src.utils:
    level: WARNING
    handlers: [console, file_error]
    propagate: no

root:
  level: INFO
  handlers: [console, file_error]